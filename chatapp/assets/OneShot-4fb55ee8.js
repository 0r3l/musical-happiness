import{bn as e,r as s,bm as M}from"./vendor-0ef69949.js";import{R as a,Q as L,E as U,A as G,a as h,b as $,c as q,g as H,d as z}from"./index-93eff672.js";import{S as J}from"./fluentui-icons-0d7f7074.js";import{B as K,g as V,e as W,D as X,f as Y}from"./fluentui-react-ff09baa3.js";const Z="_oneshotContainer_p6613_1",ee="_oneshotTopSection_p6613_8",te="_oneshotBottomSection_p6613_15",se="_oneshotTitle_p6613_25",oe="_oneshotQuestionInput_p6613_39",ne="_oneshotAnswerContainer_p6613_46",ae="_oneshotAnalysisPanel_p6613_53",ie="_oneshotSettingsSeparator_p6613_58",re="_settingsButton_p6613_62",o={oneshotContainer:Z,oneshotTopSection:ee,oneshotBottomSection:te,oneshotTitle:se,oneshotQuestionInput:oe,oneshotAnswerContainer:ne,oneshotAnalysisPanel:ae,oneshotSettingsSeparator:ie,settingsButton:re},ce="_container_cfwv2_1",le={container:ce},ue=({className:l,onClick:i})=>e.jsx("div",{className:`${le.container} ${l??""}`,children:e.jsx(K,{icon:e.jsx(J,{}),onClick:i,children:"Settings"})});function pe(){const[l,i]=s.useState(!1),[C,de]=s.useState(""),[f,he]=s.useState(""),[v,me]=s.useState(""),[r,b]=s.useState(a.Code),[w,Se]=s.useState(3),[B,_e]=s.useState(!0),[R,xe]=s.useState(!1),[T,ge]=s.useState(""),[N,Ce]=s.useState(!1),[E,fe]=s.useState(!1),m=s.useRef(""),[S,y]=s.useState(!1),[u,A]=s.useState(),[n,I]=s.useState(),[j,k]=s.useState(),[p,c]=s.useState(void 0),P=M().instance,_=async t=>{m.current=t,u&&A(void 0),y(!0),k(void 0),c(void 0);const g=P?await H(P):void 0;try{const d={messages:[{content:t,role:"user"}],context:{overrides:{prompt_template:C.length===0?void 0:C,prompt_template_prefix:f.length===0?void 0:f,prompt_template_suffix:v.length===0?void 0:v,exclude_category:T.length===0?void 0:T,top:w,retrieval_mode:r,semantic_ranker:B,semantic_captions:R,use_oid_security_filter:N,use_groups_security_filter:E}},session_state:n?n.choices[0].session_state:null},O=await z(d,g?.accessToken);I(O)}catch(d){A(d)}finally{y(!1)}},Q=(t,g,d)=>{b(g?.data||a.Code)},D=t=>{_(t)},F=t=>{j===t&&p===h.CitationTab?c(void 0):(k(t),c(h.CitationTab))},x=t=>{c(p===t?void 0:t)};return e.jsxs("div",{className:o.oneshotContainer,children:[e.jsxs("div",{className:o.oneshotTopSection,children:[e.jsx(ue,{className:o.settingsButton,onClick:()=>i(!l)}),e.jsx("h1",{className:o.oneshotTitle,children:"Ask your data"}),e.jsx("div",{className:o.oneshotQuestionInput,children:e.jsx(L,{placeholder:"Example: Does my plan cover annual eye exams?",disabled:S,onSend:t=>_(t)})})]}),e.jsxs("div",{className:o.oneshotBottomSection,children:[S&&e.jsx(V,{label:"Generating answer"}),!m.current&&e.jsx(U,{retrievalMode:r,onExampleClicked:D}),!S&&n&&!u&&e.jsx("div",{className:o.oneshotAnswerContainer,children:e.jsx(G,{answer:n,isStreaming:!1,retrievalMode:r,onCitationClicked:t=>F(t),onThoughtProcessClicked:()=>x(h.ThoughtProcessTab),onSupportingContentClicked:()=>x(h.SupportingContentTab)})}),u?e.jsx("div",{className:o.oneshotAnswerContainer,children:e.jsx($,{error:u.toString(),onRetry:()=>_(m.current)})}):null,p&&n&&e.jsx(q,{className:o.oneshotAnalysisPanel,activeCitation:j,onActiveTabChanged:t=>x(t),citationHeight:"600px",answer:n,activeTab:p})]}),e.jsx(W,{headerText:"Configure answer generation",isOpen:l,isBlocking:!1,onDismiss:()=>i(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e.jsx(X,{onClick:()=>i(!1),children:"Close"}),isFooterAtBottom:!0,children:e.jsx(Y,{className:o.oneshotSettingsSeparator,label:"Data mode",options:[{key:"code",text:"Hardened",selected:r==a.Code,data:a.Code},{key:"text",text:"Regular",selected:r==a.Text,data:a.Text}],required:!0,onChange:Q})})]})}pe.displayName="OneShot";export{pe as Component};
//# sourceMappingURL=OneShot-4fb55ee8.js.map
